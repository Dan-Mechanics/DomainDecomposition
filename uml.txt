@startuml

class FSM<T>
{
    + states : readonly Dictionary<Type, T>
    -currentState: T
    
    + void AddState(key: Type, value: T)
    + void TransitionTo(type: Type)
    + void Update()
}

interface IDamagable
{
    + void TakeDamage()
}

interface IInfectable
{
    + void Infect()
}

interface IState 
{
    + void Setup(fsm : FSM)
    + void EnterState()
    + void Update()
    + void ExitState()
}


class Timer
{
    + onTimerComplete: event Action
    
    + void SetTimer(value: float)
}

class HealthStateHandler implements IDamagable, IInfectable
{
    - fsm: readonly FSM<HealthState>
    
    + Setup()
    + void TakeDamage()
    + void Infect()
    + Update()
    - Interact(type: Type)
}

class KillerAttacks
{
    + void DealDamage()
    + void Infect()
}

class DestroyableProp implements IDamagable
{
    + void TakeDamage()
    - void Destroy();
}

abstract class HealthState implements IState 
{
    + onEnter: event Action
    + onExit: event Action
    # fsm: FSM
    
    + virtual void Setup(fsm : FSM)
    + virtual void EnterState()
    + virtual void Update()
    + virtual void ExitState()
    + virtual void Interact(type: Type)
}


class HealthyState extends HealthState 
{
    + override Setup(fsm : FSM)
    + override EnterState()
    + override Update()
    + override ExitState()
}

class InjuredState extends HealthState 
{
    + override Setup(fsm : FSM)
    + override EnterState()
    + override Update()
    + override ExitState()
}

class DeepWoundState extends HealthState 
{
    - timer : Timer
    
    + override void Setup(fsm : FSM)
    + override void EnterState()
    + override void Update()
    + override void ExitState()
    + override void Interact(type: Type)
}

class DownedState extends HealthState 
{
    -recoveryProgress: float
    
    + override void Setup(fsm : FSM)
    + override void EnterState()
    + override void Update()
    + override void ExitState()
    + override void Interact(type: Type)
}

class InfectedState extends HealthState 
{
    - timer : Timer
    
    + override void Setup(fsm : FSM)
    + override void EnterState()
    + override void Update()
    + override void ExitState()
    + override void Interact(type: Type)
}

FSM --* HealthStateHandler
Timer --* DeepWoundState
Timer --*  InfectedState
FSM ..> IState
HealthStateHandler ..> HealthState
KillerAttacks ..> IDamagable
KillerAttacks ..> IInfectable

@enduml